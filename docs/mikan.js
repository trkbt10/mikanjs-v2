(function(a,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(a=typeof globalThis<"u"?globalThis:a||self,u(a.Mikan={}))})(this,function(a){"use strict";const u=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),$=/^[〈《「『｢（\[\(【〔〚〖〘❮❬❪❨<｛{❲❰]$/u,h=/^[〉》」』｣）\]\)】〔〗〙〛❩❫❭❯❱❳❵｝}]$/u,p=/^[。、．…\.!！?？,，:：;；]+$/u,m=/^[\p{Script=Hiragana}]+$/u,S=/^(?:[\d０-９]+(?:[\.,][\d０-９]+)*|[〇零一二三四五六七八九十百千億兆京]+)$/u,H=/^[万]$/u,v=`
  px point pt pc dpi dppx
  mm cm m km μm nm センチメートル キロ メートル
  inch in ft yd mile knot ノット
  g kg t mg μg ℊ グラム キログラム トン
  l ml ℓ リットル
  s ms sec 秒 分 min h hr 時間
  Hz kHz MHz GHz
  A mA V kV W kW Wh kWh
  B KB MB GB TB KiB MiB GiB
  ¥ 円 ￥ $ ＄ € €‎ £ ₩ 元
  % ％ ‰ ‱ ㌫
  ° ℃ ℉ 度
  個 本 冊 枚 台 箱 匹 人 里 海里 畳 坪
`.trim().split(/\s+/),y=new RegExp(`^(?:${v.sort((t,i)=>i.length-t.length).map(u).join("|")})$`,"iu"),I=t=>S.test(t),N=t=>H.test(t),P=t=>y.test(t),w=["こと","もの","ため","ところ","わけ"],A=new RegExp(`^(${w.join("|")})$`,"u"),B=new RegExp(["&nbsp;","[\\s\\n]","[\\d０-９]+(?:[\\.,][\\d０-９]+)*","[A-Za-z0-9]+(?:\\.[A-Za-z]{2,})?","[\\p{Script=Katakana}ー]+","[\\p{Script=Hiragana}]+","[\\p{Script=Han}々〆ヵヶゝ]+","[〈《「『｢（\\[\\(【〔〚〖〘❮❬❪❨<｛{❲❰〉》」』｣）\\]\\)】〕〗〙〛❩❫❭❯❱❳❵｝}]","[。、．…\\.!！?？,，:：;；]+","[%％‰‱㌫]"].join("|"),"ug"),W=["",0,{は:["は",1,{}],が:["が",1,{}],を:["を",1,{"*":["*",0,{っ:["っ",0,{て:["て",1,{}]}],る:["る",1,{}],じ:["じ",1,{て:["て",1,{}]}],し:["し",1,{て:["て",1,{}]}],め:["め",1,{と:["と",0,{し:["し",0,{て:["て",1,{}]}]}]}],と:["と",0,{し:["し",0,{て:["て",1,{}]}]}],に:["に",1,{し:["し",0,{て:["て",1,{}]}]}]}],は:["は",0,{じ:["じ",0,{め:["め",1,{}]}]}],も:["も",0,{っ:["っ",0,{て:["て",1,{し:["し",0,{て:["て",1,{も:["も",1,{}]}]}]}]}]}]}],に:["に",1,{は:["は",1,{}],て:["て",1,{}],し:["し",0,{て:["て",1,{も:["も",1,{}],は:["は",1,{}]}],ろ:["ろ",1,{}]}],せ:["せ",0,{よ:["よ",1,{}]}],"*":["*",1,{て:["て",1,{は:["は",1,{}]}],と:["と",1,{}],ば:["ば",1,{}],し:["し",1,{て:["て",1,{}]}],す:["す",0,{る:["る",1,{}]}],わ:["わ",0,{ら:["ら",0,{ず:["ず",1,{}]}]}]}],あ:["あ",0,{っ:["っ",0,{て:["て",1,{}]}],た:["た",0,{り:["り",1,{}],っ:["っ",0,{て:["て",1,{}]}]}]}],お:["お",0,{い:["い",0,{て:["て",1,{}]}],け:["け",0,{る:["る",1,{}]}]}],か:["か",0,{か:["か",0,{わ:["わ",0,{ら:["ら",0,{ず:["ず",1,{}]}]}]}]}],も:["も",0,{か:["か",0,{か:["か",0,{わ:["わ",0,{ら:["ら",0,{ず:["ず",1,{}]}]}]}]}],"*":["*",0,{わ:["わ",0,{ら:["ら",0,{ず:["ず",1,{}]}]}]}]}],と:["と",0,{っ:["っ",0,{て:["て",1,{は:["は",1,{}],も:["も",1,{}]}]}]}],い:["い",0,{た:["た",0,{る:["る",0,{ま:["ま",0,{で:["で",1,{}]}]}],っ:["っ",0,{て:["て",1,{は:["は",1,{}]}]}]}]}]}],へ:["へ",1,{}],と:["と",1,{は:["は",1,{い:["い",0,{え:["え",1,{}],い:["い",0,{な:["な",0,{が:["が",0,{ら:["ら",1,{}]}]}]}],う:["う",0,{も:["も",0,{の:["の",0,{の:["の",1,{}]}]}]}]}]}],か:["か",1,{も:["も",1,{}],は:["は",1,{}],で:["で",1,{}],の:["の",1,{}]}],も:["も",1,{に:["に",1,{}],か:["か",0,{く:["く",1,{}]}],あ:["あ",0,{れ:["れ",1,{}],ろ:["ろ",0,{う:["う",1,{}]}]}]}],し:["し",0,{て:["て",1,{は:["は",1,{}],も:["も",1,{}],の:["の",1,{}]}],た:["た",1,{}]}],と:["と",0,{も:["も",0,{に:["に",1,{}]}]}],"*":["*",0,{に:["に",1,{}],え:["え",0,{ど:["ど",1,{}]}]}],い:["い",0,{え:["え",0,{ど:["ど",0,{も:["も",1,{}]}],ば:["ば",1,{}]}],う:["う",0,{と:["と",1,{}],か:["か",1,{}]}],っ:["っ",0,{た:["た",1,{ら:["ら",1,{}],と:["と",0,{こ:["こ",0,{ろ:["ろ",0,{で:["で",1,{}]}]}]}]}]}]}],な:["な",0,{る:["る",0,{と:["と",1,{}]}],れ:["れ",0,{ば:["ば",1,{}]}],っ:["っ",0,{て:["て",1,{は:["は",1,{}]}]}]}],こ:["こ",0,{ろ:["ろ",0,{で:["で",1,{}],が:["が",1,{}],へ:["へ",1,{}],に:["に",1,{}]}]}]}],で:["で",1,{は:["は",1,{な:["な",0,{い:["い",1,{か:["か",1,{}]}],か:["か",0,{ろ:["ろ",0,{う:["う",1,{か:["か",1,{}]}]}]}],く:["く",1,{て:["て",1,{}]}]}],あ:["あ",0,{る:["る",0,{が:["が",1,{}]}]}]}],も:["も",1,{っ:["っ",0,{て:["て",1,{}]}],な:["な",0,{お:["お",1,{}]}],あ:["あ",0,{る:["る",1,{}],り:["り",1,{}]}]}],し:["し",0,{て:["て",1,{}],た:["た",1,{ら:["ら",1,{}]}]}],さ:["さ",0,{え:["え",1,{も:["も",1,{}]}]}]}],の:["の",1,{に:["に",1,{は:["は",1,{}],も:["も",1,{}]}]}],も:["も",1,{の:["の",1,{の:["の",1,{}],を:["を",1,{}],だ:["だ",1,{か:["か",0,{ら:["ら",1,{}]}]}],か:["か",1,{}],な:["な",0,{ら:["ら",1,{}]}]}],し:["し",0,{く:["く",0,{は:["は",1,{}]}]}]}],や:["や",1,{ら:["ら",1,{か:["か",1,{}],な:["な",0,{ん:["ん",0,{や:["や",0,{ら:["ら",1,{}]}]}]}],で:["で",1,{}]}]}],か:["か",1,{ら:["ら",1,{も:["も",1,{}],は:["は",1,{}],こ:["こ",0,{そ:["そ",1,{}]}],し:["し",0,{て:["て",1,{}]}],に:["に",0,{は:["は",1,{}]}],と:["と",0,{い:["い",0,{っ:["っ",0,{て:["て",1,{}]}]}]}]}],と:["と",0,{"*":["*",0,{え:["え",0,{ば:["ば",1,{}]}],う:["う",0,{と:["と",1,{}]}]}],い:["い",0,{う:["う",0,{と:["と",1,{}]}],え:["え",0,{ば:["ば",1,{}]}],っ:["っ",0,{て:["て",1,{}]}]}]}],ど:["ど",0,{う:["う",0,{か:["か",1,{}]}]}],し:["し",0,{ら:["ら",1,{}]}],な:["な",1,{}],も:["も",1,{し:["し",0,{れ:["れ",0,{な:["な",0,{い:["い",1,{}]}]}]}]}],の:["の",0,{よ:["よ",0,{う:["う",0,{に:["に",1,{}],な:["な",1,{}]}]}],ご:["ご",0,{と:["と",0,{く:["く",1,{}],き:["き",1,{}]}]}]}]}],ね:["ね",1,{}],よ:["よ",1,{り:["り",1,{も:["も",1,{}],は:["は",1,{}],か:["か",1,{}]}]}],ぞ:["ぞ",1,{}],ぜ:["ぜ",1,{}],さ:["さ",1,{え:["え",1,{も:["も",1,{}],は:["は",1,{}]}],て:["て",0,{は:["は",1,{}]}]}],わ:["わ",1,{}],な:["な",0,{の:["の",1,{}],が:["が",0,{ら:["ら",1,{も:["も",1,{}],に:["に",1,{し:["し",0,{て:["て",1,{}]}]}]}]}],ど:["ど",1,{は:["は",1,{}],も:["も",1,{}],か:["か",1,{}],と:["と",1,{い:["い",0,{う:["う",1,{}]}]}],で:["で",1,{}],に:["に",1,{}]}],ん:["ん",0,{て:["て",1,{}],か:["か",1,{}]}],い:["い",0,{し:["し",1,{は:["は",1,{}]}]}]}],ま:["ま",0,{で:["で",1,{も:["も",1,{}],は:["は",1,{}],に:["に",1,{}],し:["し",0,{て:["て",1,{}]}],が:["が",1,{}]}],た:["た",0,{は:["は",1,{}]}]}],ば:["ば",0,{か:["か",0,{り:["り",1,{で:["で",1,{な:["な",0,{く:["く",1,{}]}],は:["は",1,{}]}],だ:["だ",1,{}],か:["か",1,{}],に:["に",1,{}]}]}]}],だ:["だ",0,{け:["け",1,{は:["は",1,{}],に:["に",1,{}],し:["し",0,{か:["か",1,{}]}],で:["で",0,{な:["な",0,{く:["く",1,{}]}],は:["は",1,{}]}],ど:["ど",1,{も:["も",1,{}]}]}],に:["に",1,{}],っ:["っ",0,{て:["て",1,{}]}],の:["の",1,{}]}],ほ:["ほ",0,{ど:["ど",1,{に:["に",1,{}],の:["の",1,{}],で:["で",0,{は:["は",1,{}],も:["も",1,{}]}]}]}],て:["て",0,{も:["も",1,{な:["な",0,{お:["お",1,{}]}],ま:["ま",0,{だ:["だ",1,{}]}],い:["い",0,{い:["い",1,{}]}],よ:["よ",0,{い:["い",1,{}]}]}]}],く:["く",0,{ら:["ら",0,{い:["い",1,{}]}]}],ぐ:["ぐ",0,{ら:["ら",0,{い:["い",1,{}]}]}],し:["し",0,{か:["か",1,{}]}],こ:["こ",0,{そ:["そ",1,{}]}],す:["す",0,{ら:["ら",1,{}]}],け:["け",0,{れ:["れ",0,{ど:["ど",1,{も:["も",1,{}]}]}],ど:["ど",1,{も:["も",1,{さ:["さ",1,{}]}]}]}],っ:["っ",0,{て:["て",1,{ば:["ば",1,{}]}],た:["た",0,{っ:["っ",0,{て:["て",1,{}]}]}]}],じ:["じ",0,{ゃ:["ゃ",1,{あ:["あ",1,{}],ね:["ね",1,{}],ん:["ん",1,{}],な:["な",0,{い:["い",1,{か:["か",1,{}]}]}]}]}],つ:["つ",0,{つ:["つ",1,{も:["も",1,{}],あ:["あ",0,{る:["る",1,{}]}]}],い:["い",0,{て:["て",0,{は:["は",1,{}]}]}]}],あ:["あ",0,{る:["る",0,{い:["い",0,{は:["は",1,{}]}]}]}]}],E=new Set(["は","が","を","に","へ","と","で","の","も","や","か","ね","よ","ぞ","ぜ","さ","わ","な","ま","ば","だ","ほ","て","く","ぐ","し","こ","す","け","っ","じ","つ","あ"]),g="*",d=t=>{const[i,r,n]=t,s={value:i,isTerminal:!!r,children:new Map};for(const[c,e]of Object.entries(n))s.children.set(c,d(e));return s},b=(t=>d(t))(W),j=(t,i)=>{let r=t;const n=Array.from(i);for(const s of n){if(!r.children.has(s))return!1;r=r.children.get(s)}return r.isTerminal},M=(t,i,r)=>{let n=t,s=null,c="",e=r;for(;e<i.length;){const l=i[e];let f=!1;if(n.children.has(l)&&(n=n.children.get(l),c+=l,e++,f=!0,n.isTerminal&&(s=c)),!f&&n.children.has(g)){const o=e;for(;e<i.length&&/[\p{Script=Han}々〆ヵヶゝ]/u.test(i[e]);)e++;e>o&&(n=n.children.get(g),c+=i.substring(o,e),f=!0,n.isTerminal&&(s=c))}if(!f)break}return s},k=t=>j(b,t),R=(t,i)=>M(b,t,i),z=t=>i=>{let r=i,n=t[r];const s=()=>r+1<t.length,c=()=>s()?t[r+1]:void 0,e=()=>(s()&&(n+=t[++r]),{current:n,index:r});return{hasNext:s,peek:c,combine:e,combineIf:o=>s()&&o?e():{current:n,index:r},combineWhile:o=>{for(;s()&&c()&&o(c());)e();return{current:n,index:r}},get value(){return n},get pos(){return r}}},L=t=>{if(!/^[\p{Script=Hiragana}]+$/u.test(t)||t.length<=2)return[t];const i=[];let r=0;for(let n=0;n<t.length;n++){const s=R(t,n);if(s){if(s==="や"&&n<t.length-1)continue;if(s==="でも"&&n+s.length<t.length){const c=t.substring(n+s.length);if(/^(ない|なく|なかっ|なけれ)/.test(c))continue}n>r?i.push(t.substring(r,n)+s):i.length>0?i[i.length-1]+=s:i.push(s),r=n+s.length,n=r-1}}return r<t.length&&i.push(t.substring(r)),i},x=(t,i)=>!!(h.test(t.slice(-1))&&i==="でも"),T=t=>{if(!t)return[""];const i=[...t.matchAll(B)].map(e=>e[0]),r=[];for(const e of i)r.push(...L(e));const n=[],s=z(r);let c=0;for(;c<r.length;){const e=s(c);if(/^[\p{Script=Han}々〆ヵヶゝ]+$/u.test(e.value)&&e.peek()&&m.test(e.peek())){for(;e.peek()&&m.test(e.peek())&&!(A.test(e.peek())||E.has(e.peek())&&e.peek().length>1);)if(e.combine(),e.peek()&&p.test(e.peek())){e.combine();break}}e.combineIf(/^[\p{Script=Katakana}ー]+$/u.test(e.value)&&e.peek()==="な"),I(e.value)&&e.peek()&&(P(e.peek())||N(e.peek()))&&(e.combine(),e.combineIf(e.peek()?p.test(e.peek()):!1),e.combineIf(e.peek()?/^[\p{Script=Hiragana}]+$/u.test(e.peek()):!1)),$.test(e.value)&&(e.combineWhile(l=>!h.test(l)),e.combineIf(!0)),e.peek()&&k(e.peek())&&!k(e.value)&&(x(e.value,e.peek())||e.combine()),e.value==="でも"&&e.peek()&&/^(ない|なく|なかっ|なけれ)/.test(e.peek())&&(e.combine(),e.combineIf(e.peek()?p.test(e.peek()):!1)),e.combineIf(e.peek()?p.test(e.peek())&&!p.test(e.value):!1),n.push(e.value),c=e.pos+1}return n},K=(t,i={})=>{const n=` style="display:inline-block${i.style?";"+i.style:""}"`+(i.aria??!0?' role="presentation"':"")+(i.className?` class="${i.className}"`:"");return T(t).map(s=>`<span${n}>${s}</span>`).join("")};a.toHTML=K,a.tokenize=T,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=mikan.js.map
